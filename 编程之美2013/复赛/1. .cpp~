#include <iostream>
#include <cstring>
#include <cstdio>
using namespace std;

int compareStr(char *s1, char *s2)
{
    int len1 = strlen(s1);
    int len2 = strlen(s2);
    int i1, i2;
    for(i1 = 0, i2 = 0;i1 < len1 && i2 < len2;i1++, i2++)
    {
        if (s1[i1] > s2[i2])
            return 1;
        else if (s1[i1] < s2[i2])
            return -1;
    }

    if (i1 < len1)
        return 1;
    else if (i2 < len2)
        return -1;
    return 0;
}

int convertZ(char *str)
{
    int len = strlen(str);
    int i;
    for(i = len - 1;i >= 0;i--)
        if (str[i] == '0')
        {
            str[i] = '1';
            break;
        }
    if (i >= 0)
        return true;
    else
        return false;
}

int calOne(char *str)
{
    int len = strlen(str);
    int oneNum = 0;
    for(int i = 0;i < len;i++)
        if (str[i] == '1')
            oneNum++;
    return oneNum;
}

char arrStr[50005][1000];
char str[1000];
int flag[50005][2];

int main()
{
    int ncase;
    scanf("%d", &ncase);
    for(int icase = 1;icase <= ncase;icase++)
    {
        memset(flag, -1, sizeof(flag));
        int n;
        scanf("%d", &n);
        flag[0][0] = 0;flag[0][1] = 0;
        flag[n + 1][1] = n + 1;flag[n + 1][0] = n + 1;
        strcpy(arrStr[0], "0");
        strcpy(arrStr[n + 1], "1");

        int digNum = 0;
        int oneNum = 0;
        for(int i = 0;i < n;i++)
        {
            int a;
            scanf("%d", &a);
            int k;
            if (flag[a][0] == -1)
            {
                for(k = a - 1;flag[k][0] == -1;k--)
                    flag[k][1] = a;
                flag[a][0] = flag[k][0];
                flag[k][1] = a;
            }
            if (flag[a][1] == -1)
            {
                for(k = a + 1;flag[k][1] == -1;k++)
                    flag[k][0] = a;
                flag[a][1] = flag[k][1];
                flag[k][0] = a;
            }

            strcpy(str, arrStr[flag[a][0]]);
            printf("left %d right %d\n", flag[a][0], flag[a][1]);
            int conRes = convertZ(str);
            if (!conRes || compareStr(str, arrStr[flag[a][1]]) >= 0)
            {
                int addZ = 1;
                strcpy(str, arrStr[flag[a][0]]);
                int ll = strlen(str);
               // printf("str %s\n", str);
                str[ll] = '1';
                str[ll + 1] = '\0';

                while(compareStr(str, arrStr[flag[a][1]]) >= 0)
                {
                    for(int i = 0;i < addZ;i++)
                        str[ll + i] = '0';
                    str[ll + addZ] = '1';
                    str[ll + addZ + 1] = '\0';
                    addZ++;
                }
            }
            strcpy(arrStr[a], str);
            printf("%s\n", str);
            digNum += strlen(str);
            oneNum += calOne(str);
        }
        printf("Case #%d: %d %d\n", icase, digNum + 2, oneNum + 1);
    }
    return 0;

}

